{
  "projectName": "Bus Control",
  "generatedAt": "2026-02-21",
  "rootDirectory": "d:\\domains\\Pets\\GameStudio\\Bus Control\\ProjectBusControl",
  "totalFiles": 82,
  "architecture": "Feature-Sliced Design (FSD)",
  "structure": [
    {
      "path": ".gitignore",
      "type": "config",
      "description": "Git ignore file"
    },
    {
      "path": ".prettierrc",
      "type": "config",
      "description": "Настройки форматирования Prettier (LF, singleQuote, 2 spaces)"
    },
    {
      "path": ".editorconfig",
      "type": "config",
      "description": "EditorConfig для единообразия кода (LF endings)"
    },
    {
      "path": "eslint.config.js",
      "type": "config",
      "description": "Конфигурация линтера ESLint"
    },
    {
      "path": "index.html",
      "type": "template",
      "description": "HTML-шаблон точки входа"
    },
    {
      "path": "package.json",
      "type": "config",
      "description": "Манифест проекта: зависимости, скрипты"
    },
    {
      "path": "package-lock.json",
      "type": "lock",
      "description": "Зафиксированные версии зависимостей"
    },
    {
      "path": "README.md",
      "type": "docs",
      "description": "Документация проекта"
    },
    {
      "path": "instructions.md",
      "type": "docs",
      "description": "Инструкции по разработке (MVP, FSD, ошибки)"
    },
    {
      "path": "tsconfig.json",
      "type": "config",
      "description": "Базовая конфигурация TypeScript"
    },
    {
      "path": "tsconfig.app.json",
      "type": "config",
      "description": "TypeScript для приложения (с алиасом @/*)"
    },
    {
      "path": "tsconfig.node.json",
      "type": "config",
      "description": "TypeScript для Node-окружения"
    },
    {
      "path": "vite.config.ts",
      "type": "config",
      "description": "Конфигурация Vite (с алиасом @)"
    },
    {
      "path": "public/vite.svg",
      "type": "asset",
      "description": "SVG-иконка Vite"
    },
    {
      "path": "src/main.tsx",
      "type": "source",
      "description": "Точка входа React-приложения"
    },
    {
      "path": "src/App.tsx",
      "type": "source",
      "description": "Корневой компонент (GameCanvas + UI виджеты)"
    },
    {
      "path": "src/index.css",
      "type": "styles",
      "description": "Глобальные стили"
    },
    {
      "path": "src/app/init.ts",
      "type": "source",
      "description": "Инициализация игрового ядра (все сервисы + экономика + сохранение)"
    },
    {
      "path": "src/app/store/GameStateStore.ts",
      "type": "source",
      "description": "Хранилище состояния игры (деньги, статистика, пауза)"
    },
    {
      "path": "src/shared/lib/game-core/GameLoopService.ts",
      "type": "source",
      "description": "Игровой цикл (fixed timestep для логики)"
    },
    {
      "path": "src/shared/lib/game-core/CanvasRendererService.ts",
      "type": "source",
      "description": "Рендеринг на Canvas (слои, примитивы, камера, getCamera/getCanvas)"
    },
    {
      "path": "src/shared/lib/game-core/EntityManagerService.ts",
      "type": "source",
      "description": "ECS: управление сущностями и системами"
    },
    {
      "path": "src/shared/lib/game-core/GameEventBusService.ts",
      "type": "source",
      "description": "Шина событий (Pub/Sub для React ↔ Canvas)"
    },
    {
      "path": "src/shared/lib/game-core/InputService.ts",
      "type": "source",
      "description": "Ввод: мышь, клавиатура, тач (с конвертацией координат)"
    },
    {
      "path": "src/shared/lib/game-core/ResourceLoaderService.ts",
      "type": "source",
      "description": "Загрузка ресурсов (кэш, placeholders)"
    },
    {
      "path": "src/shared/lib/game-core/CameraController.ts",
      "type": "source",
      "description": "Камера: панорамирование (СКМ), зум (колесо), getViewport/setViewport"
    },
    {
      "path": "src/entities/Bus/model/BusComponents.ts",
      "type": "source",
      "description": "Компоненты автобуса: POSITION, VELOCITY, DATA"
    },
    {
      "path": "src/entities/Bus/model/BusMovementSystem.ts",
      "type": "source",
      "description": "Движение: ускорение, плавное торможение по формуле d=v²/(2*a)"
    },
    {
      "path": "src/entities/Bus/model/BusLogicSystem.ts",
      "type": "source",
      "description": "Логика: состояния IDLE, MOVING_TO_STOP, STOPPED (зацикленные маршруты)"
    },
    {
      "path": "src/entities/Bus/model/BusRenderSystem.ts",
      "type": "source",
      "description": "Рендеринг: жёлтый прямоугольник 40×20 с фарами"
    },
    {
      "path": "src/entities/Bus/index.ts",
      "type": "source",
      "description": "Экспорт Bus"
    },
    {
      "path": "src/entities/NPC/model/NPCComponents.ts",
      "type": "source",
      "description": "Компоненты NPC: POSITION (с targetStopId), DATA"
    },
    {
      "path": "src/entities/NPC/model/NPCSpawnerSystem.ts",
      "type": "source",
      "description": "Спавн пассажиров с выбором цели из остановок дальше по маршруту"
    },
    {
      "path": "src/entities/NPC/model/NPCInteractionSystem.ts",
      "type": "source",
      "description": "Посадка/высадка: оплата $2 при посадке, высадка на своей остановке"
    },
    {
      "path": "src/entities/NPC/model/NPCRenderSystem.ts",
      "type": "source",
      "description": "Рендеринг NPC: белые (ожидают), синие (в автобусе)"
    },
    {
      "path": "src/entities/NPC/index.ts",
      "type": "source",
      "description": "Экспорт NPC"
    },
    {
      "path": "src/entities/Route/model/RouteComponents.ts",
      "type": "source",
      "description": "Компоненты маршрута (stopIds, color, loop)"
    },
    {
      "path": "src/entities/Route/model/RouteRenderSystem.ts",
      "type": "source",
      "description": "Рендеринг маршрутов (линии на слое roads, название)"
    },
    {
      "path": "src/entities/Route/index.ts",
      "type": "source",
      "description": "Экспорт Route"
    },
    {
      "path": "src/entities/stop/model/StopComponents.ts",
      "type": "source",
      "description": "Компоненты остановки (позиция, данные)"
    },
    {
      "path": "src/entities/stop/model/StopRenderSystem.ts",
      "type": "source",
      "description": "Рендеринг остановок (круги, надписи, счётчик пассажиров, hover-подсветка, ✏️ иконка)"
    },
    {
      "path": "src/entities/stop/index.ts",
      "type": "source",
      "description": "Экспорт Stop"
    },
    {
      "path": "src/features/map-editor/model/MapEditorService.ts",
      "type": "source",
      "description": "Редактор карт: режимы остановок/маршрутов, ПКМ=автобус/переименование, L=зацикливание"
    },
    {
      "path": "src/features/map-save/model/MapSaveService.ts",
      "type": "source",
      "description": "Сохранение карт: localStorage, автосохранение, пресеты, экспорт/импорт JSON"
    },
    {
      "path": "src/features/map-save/model/types.ts",
      "type": "source",
      "description": "Типы для сохранения (MapSaveData, SavedStop, SavedRoute, SavedBus)"
    },
    {
      "path": "src/features/map-save/model/preset-maps.ts",
      "type": "source",
      "description": "Пресетные карты (simple, city, complex, grid)"
    },
    {
      "path": "src/features/map-save/index.ts",
      "type": "source",
      "description": "Экспорт map-save"
    },
    {
      "path": "src/features/economy/model/EconomyListener.ts",
      "type": "source",
      "description": "Слушатель экономики: $2 за посадку, $5 за доставку, -$100 за автобус"
    },
    {
      "path": "src/features/economy/index.ts",
      "type": "source",
      "description": "Экспорт экономики"
    },
    {
      "path": "src/widgets/game-canvas/index.ts",
      "type": "source",
      "description": "Экспорт GameCanvas"
    },
    {
      "path": "src/widgets/game-canvas/ui/GameCanvas.tsx",
      "type": "source",
      "description": "React-виджет: Canvas-контейнер"
    },
    {
      "path": "src/widgets/game-canvas/ui/GameCanvas.module.scss",
      "type": "styles",
      "description": "Стили GameCanvas (100vw, 100vh)"
    },
    {
      "path": "src/widgets/stats-panel/index.ts",
      "type": "source",
      "description": "Экспорт StatsPanel"
    },
    {
      "path": "src/widgets/stats-panel/ui/StatsPanel.tsx",
      "type": "source",
      "description": "Виджет статистики: баланс, перевезено, автобусов, остановок"
    },
    {
      "path": "src/widgets/stats-panel/ui/StatsPanel.module.scss",
      "type": "styles",
      "description": "Стили StatsPanel (левый верхний угол)"
    },
    {
      "path": "src/widgets/toolbar/index.ts",
      "type": "source",
      "description": "Экспорт Toolbar"
    },
    {
      "path": "src/widgets/toolbar/ui/Toolbar.tsx",
      "type": "source",
      "description": "Панель инструментов: режимы, покупка автобуса"
    },
    {
      "path": "src/widgets/toolbar/ui/Toolbar.module.scss",
      "type": "styles",
      "description": "Стили Toolbar (внизу по центру)"
    },
    {
      "path": "src/widgets/notifications/index.ts",
      "type": "source",
      "description": "Экспорт Notifications"
    },
    {
      "path": "src/widgets/notifications/ui/Notifications.tsx",
      "type": "source",
      "description": "Виджет уведомлений: успех, предупреждения, информация"
    },
    {
      "path": "src/widgets/notifications/ui/Notifications.module.scss",
      "type": "styles",
      "description": "Стили Notifications (правый верхний угол)"
    },
    {
      "path": "src/widgets/map-manager/index.ts",
      "type": "source",
      "description": "Экспорт MapManager"
    },
    {
      "path": "src/widgets/map-manager/ui/MapManager.tsx",
      "type": "source",
      "description": "Виджет управления картой: пресеты, сохранение/загрузка, экспорт/импорт"
    },
    {
      "path": "src/widgets/map-manager/ui/MapManager.module.scss",
      "type": "styles",
      "description": "Стили MapManager (правый нижний угол)"
    }
  ],
  "modules": {
    "game-core": {
      "path": "src/shared/lib/game-core",
      "description": "Ядро движка: цикл, рендер, ECS, события, ввод, ресурсы, камера",
      "services": [
        "GameLoopService",
        "CanvasRendererService",
        "EntityManagerService",
        "GameEventBusService",
        "InputService",
        "ResourceLoaderService",
        "CameraController"
      ]
    },
    "entities": {
      "path": "src/entities",
      "description": "Игровые сущности (Business Entities по FSD)",
      "items": ["Bus", "NPC", "Route", "Stop"]
    },
    "features": {
      "path": "src/features",
      "description": "Фичи (user actions по FSD)",
      "items": ["map-editor", "map-save", "economy"]
    },
    "widgets": {
      "path": "src/widgets",
      "description": "UI-виджеты",
      "items": ["game-canvas", "stats-panel", "toolbar", "notifications", "map-manager"]
    },
    "app": {
      "path": "src/app",
      "description": "Слой приложения (инициализация, стейт)",
      "items": ["init.ts", "store/GameStateStore.ts"]
    }
  },
  "gameplay": {
    "controls": {
      "ЛКМ": "Создать остановку / Добавить точку в маршрут",
      "ПКМ (по остановке)": "Переименовать остановку",
      "ПКМ (по линии)": "Создать автобус на маршруте",
      "СКМ (зажать)": "Перемещение карты (панорамирование)",
      "Колесо": "Зум в точку курсора",
      "Клавиша 1": "Режим строительства остановок",
      "Клавиша 2": "Режим построения маршрутов",
      "Клавиша L": "Переключить зацикливание маршрута (в режиме построения)",
      "Enter": "Завершить маршрут",
      "Escape": "Отменить построение маршрута"
    },
    "layers": ["background", "roads", "entities", "ui"],
    "features": {
      "implemented": [
        "Создание остановок (зелёные круги)",
        "Построение маршрутов (синие линии)",
        "Зацикленные маршруты (клавиша L)",
        "Создание автобуса (ПКМ по маршруту или кнопка)",
        "Покупка автобуса через Toolbar ($100)",
        "Переименование остановок (ПКМ по остановке → prompt)",
        "Визуальная подсказка переименования (✏️ иконка, hover-подсветка)",
        "Движение автобуса с ускорением и торможением",
        "Перемещение камеры (СКМ)",
        "Зум камеры (колесо)",
        "Спавн пассажиров на остановках (каждые 2 сек)",
        "Пассажиры выбирают цель из остановок дальше по маршруту",
        "Посадка пассажиров в автобус",
        "Оплата проезда при посадке ($2)",
        "Высадка пассажиров на своей остановке",
        "Бонус за доставку пассажира ($5)",
        "Экономика (+$7 за пассажира, -$100 за автобус)",
        "Сохранение/загрузка карты (localStorage, автосохранение)",
        "Пресетные карты (simple, city, complex, grid)",
        "Экспорт/импорт карты (JSON)",
        "UI: StatsPanel (статистика слева сверху)",
        "UI: Toolbar (панель инструментов внизу)",
        "UI: Notifications (уведомления справа сверху)",
        "UI: MapManager (управление картой справа снизу)"
      ],
      "planned": [
        "Визуальное отображение зацикленности маршрута",
        "Настройки игры",
        "Редактирование маршрутов (удаление остановок)"
      ]
    }
  },
  "economy": {
    "income": {
      "passengerFare": 2,
      "deliveryBonus": 5,
      "totalPerPassenger": 7
    },
    "expenses": {
      "busPurchase": 100
    }
  }
}
